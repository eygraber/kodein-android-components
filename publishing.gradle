apply plugin: 'org.jetbrains.dokka'
apply plugin: 'com.vanniktech.maven.publish'

publishing {
  repositories {
    maven {
      def releasesRepoUrl = "https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/"
      def snapshotsRepoUrl = "https://s01.oss.sonatype.org/content/repositories/snapshots/"
      url = version.endsWith('SNAPSHOT') ? snapshotsRepoUrl : releasesRepoUrl
      name = "mavenCentral"
    }
  }
}

mavenPublish {
  releaseSigningEnabled = !getGpgKey().isEmpty()

  nexus {
    baseUrl = 'https://s01.oss.sonatype.org/service/local/'
  }
}

def getGpgKey() {
  return findProperty("signingKey") ?: ""
}

signing {
  def signingKey = getGpgKey()
  if(!signingKey.isEmpty()) {
    useInMemoryPgpKeys(signingKey, "")
  }
}
